<section class="user">
  <%= profile_image(@user) %>
  <% if @user == current_user %>
    <h3>Welcome, <%= @user.username %></h3>
  <% end %>
  <h2><%= @user.name %></h2>
  <p><%= mail_to @user.email %></p>
  <p>Member since: <%= @user.created_at.strftime("%B %Y") %></p>
  <div class="actions">
    <% if current_user?(@user) %>
    <%= link_to "Edit Account", 
      edit_user_path(@user), class: "button edit" %>
    <% end %>
    <% if current_user_admin? %>
      <%= link_to "Delete Account",
        user_path(@user), 
        data: { turbo_method: :delete, turbo_confirm: "Are you sure you want to delete this account?" },      class: "button delete" %>
    <% end %>
  </div>

  <% if @reviews.present? %>
    <h3>My Reviews</h3>
    <% @reviews.each do |r| %>
      <div class="review">
        <div class="details">
          <span class="title">
            <%= link_to r.movie.title, r.movie %>
          </span>
          <%= pluralize(r.stars, 'star') %>
          <span class="date">
            <%= time_ago_in_words(r.created_at) %> ago.
          </span>
          <p>
            <%= r.comment %>
          </p>
        </div>
      </div>
    <% end %>
  <% end %>
  <% if @favourite_movies.present? %>
    <h4>Favourite Movies</h4>
    <div class="favourite-movies">
    <% @favourite_movies.each do | movie | %>
      <%= link_to main_image(movie), movie %>
    <% end %>
    </div>
  <% end %>
</section>
